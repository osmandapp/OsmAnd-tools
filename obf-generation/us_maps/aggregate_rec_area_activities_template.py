#!/usr/bin/python3
# Append the path where processing plugins can be found
import sys
sys.path.append('/usr/share/qgis/python/plugins/')
from qgis.core import *
from qgis.analysis import QgsNativeAlgorithms

qgs = QgsApplication([], False)
import processing
from processing.core.Processing import Processing
Processing.initialize()
from processing.tools import dataobjects

QgsApplication.processingRegistry().addProvider(QgsNativeAlgorithms())

processing.run("native:aggregate", {'INPUT':'INPUT_FILE|layername=RECAREAACTIVITIES_V','GROUP_BY':' geom_to_wkt($geometry )','AGGREGATES':[{'aggregate': 'first_value','delimiter': ',','input': '"OBJECTID"','length': 0,'name': 'OBJECTID','precision': 0,'sub_type': 0,'type': 4,'type_name': 'int8'},{'aggregate': 'concatenate_unique','delimiter': ';','input': '"RECAREANAME"','length': 1500,'name': 'RECAREANAME','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"LONGITUDE"','length': 200,'name': 'LONGITUDE','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"LATITUDE"','length': 100,'name': 'LATITUDE','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"RECAREAURL"','length': 256,'name': 'RECAREAURL','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"FEEDESCRIPTION"','length': 1024,'name': 'FEEDESCRIPTION','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"OPEN_SEASON_START"','length': 200,'name': 'OPEN_SEASON_START','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"OPERATIONAL_HOURS"','length': 1000,'name': 'OPERATIONAL_HOURS','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"OPEN_SEASON_END"','length': 200,'name': 'OPEN_SEASON_END','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"FORESTNAME"','length': 256,'name': 'FORESTNAME','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"RESERVATION_INFO"','length': 2000,'name': 'RESERVATION_INFO','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"RECAREAID"','length': 0,'name': 'RECAREAID','precision': 0,'sub_type': 0,'type': 2,'type_name': 'integer'},{'aggregate': 'first_value','delimiter': ',','input': '"MARKERTYPE"','length': 50,'name': 'MARKERTYPE','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"MARKERACTIVITY"','length': 100,'name': 'MARKERACTIVITY','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"MARKERACTIVITYGROUP"','length': 100,'name': 'MARKERACTIVITYGROUP','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"RECAREADESCRIPTION"','length': 0,'name': 'RECAREADESCRIPTION','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"RESTRICTIONS"','length': 0,'name': 'RESTRICTIONS','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"ACTIVITYDESCRIPTION"','length': 0,'name': 'ACTIVITYDESCRIPTION','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"PARENTACTIVITYNAME"','length': 1000,'name': 'PARENTACTIVITYNAME','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'concatenate_unique','delimiter': ';','input': '"ACTIVITYNAME"','length': 2000,'name': 'ACTIVITYNAME','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"ACTIVITYID"','length': 0,'name': 'ACTIVITYID','precision': 0,'sub_type': 0,'type': 2,'type_name': 'integer'},{'aggregate': 'first_value','delimiter': ',','input': '"PARENTACTIVITYID"','length': 0,'name': 'PARENTACTIVITYID','precision': 0,'sub_type': 0,'type': 2,'type_name': 'integer'},{'aggregate': 'first_value','delimiter': ',','input': '"SPOTLIGHTDISPLAY"','length': 1,'name': 'SPOTLIGHTDISPLAY','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"ATTRACTIONDISPLAY"','length': 1,'name': 'ATTRACTIONDISPLAY','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'first_value','delimiter': ',','input': '"ACCESSIBILITY"','length': 0,'name': 'ACCESSIBILITY','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'},{'aggregate': 'concatenate_unique','delimiter': ';','input': '"OPENSTATUS"','length': 200,'name': 'OPENSTATUS','precision': 0,'sub_type': 0,'type': 10,'type_name': 'text'}],'OUTPUT':'OUTPUT_FILE'})